# Module 05 λ³΄μ¶©: λ©”λ¨λ¦¬ μ•μ „μ„± (Memory Safety)

## 1. λ•κΈ€λ§ ν¬μΈν„° (Dangling Pointer) π‘»
"λ§¤λ‹¬λ ¤ μλ” ν¬μΈν„°"λΌλ” λ»μ…λ‹λ‹¤. μ΄λ―Έ `delete` λμ–΄μ„ μ‚¬λΌμ§„ λ©”λ¨λ¦¬λ¥Ό μ—¬μ „ν κ°€λ¦¬ν‚¤κ³  μλ” ν¬μΈν„°λ¥Ό λ§ν•©λ‹λ‹¤.

### 1.1 μ„ν—μ„±
```cpp
int* p = new int(10);
delete p; // λ©”λ¨λ¦¬ λ°λ‚© μ™„λ£!

// ... 100μ¤„ λ’¤ ...

*p = 20; // μΌμ•…! μ΄λ―Έ λ°λ‚©ν• λ•…μ— μΉ¨λ²” (Use-After-Free λ²„κ·Έ)
// μ΄ μΆ‹μΌλ©΄ ν¬λμ‹, μ΄ λ‚μλ©΄ μ λμ•„κ°€λ‹¤κ°€ λ‚μ¤‘μ— λ°μ΄ν„° μ¤μ—Ό λ°μƒ
```

### 1.2 `delete p`μ μ§„μ‹¤ (μ¤‘μ” β­)
**Q: `delete p`λ¥Ό ν•λ©΄ `p` λ³€μλ„ μ‚¬λΌμ§€λ‚μ”?**
A: **μ•„λ‹μ”!** `p`κ°€ κ°€λ¦¬ν‚¤λ **"ν™ λ©”λ¨λ¦¬μ μ§‘(λ°μ΄ν„°)"λ§ μ² κ±°**λ©λ‹λ‹¤.
`p`κ°€ λ“¤κ³  μλ **"μ£Όμ†κ°’(μ½μ§€)"**μ€ κ·Έλ€λ΅ λ‚¨μ•„μμµλ‹λ‹¤. (μ² κ±°λ μ§‘ μ£Όμ†λ¥Ό λ“¤κ³  μλ” μƒνƒ)
μ΄ μƒνƒμ ν¬μΈν„°λ¥Ό **λ•κΈ€λ§ ν¬μΈν„°**λΌκ³  λ¶€λ¦…λ‹λ‹¤.

### 1.3 `delete pp` (μ΄μ¤‘ ν¬μΈν„°)λ¥Ό ν•λ©΄μ”? π±
**Q: `SafeDelete(int** pp)` ν•¨μ μ•μ—μ„ `delete pp`λ¥Ό ν•λ©΄ `pp->p->data` μ¤‘ `p`κ°€ μ‚¬λΌμ§€λ‚μ”?**
A: **μ•„λ‹μ”! ν”„λ΅κ·Έλ¨μ΄ ν„°μ§‘λ‹λ‹¤!** (Crash)
- `pp`λ” `main` ν•¨μ μ¤νƒμ— μλ” `p`μ μ£Όμ†λ¥Ό κ°€μ§€κ³  μμµλ‹λ‹¤. (μ¤νƒ λ©”λ¨λ¦¬ μ£Όμ†)
- `delete`λ” μ¤μ§ **"ν™(Heap) λ©”λ¨λ¦¬ μ£Όμ†"**λ§ λ°›μ„ μ μμµλ‹λ‹¤.
- μ¤νƒ μ£Όμ†λ¥Ό `delete` ν•λ ¤κ³  ν–μΌλ‹, μ΄μμ²΄μ κ°€ "λ‚΄ λ•… μ•„λ‹λ° μ™ κ±΄λ“λ ¤?" ν•κ³  ν”„λ΅κ·Έλ¨μ„ κ°•μ  μΆ…λ£μ‹ν‚µλ‹λ‹¤.
- **μ •λ‹µ**: `delete *pp`λ¥Ό ν•΄μ•Ό ν•©λ‹λ‹¤. (`*pp`λ” ν™μ— μλ” λ°μ΄ν„°λ¥Ό κ°€λ¦¬ν‚¤λ” μ£Όμ†λ‹κΉμ”!)

### 1.4 `pp = nullptr`μ€ μ• ν•λ‚μ”?
**Q: `*pp`λ” μ§€μ°κ³  λ‚μ„ `nullptr`λ΅ λ§λ“λ”λ°, μ™ `pp`λ” `nullptr`λ΅ μ• λ§λ“λ‚μ”?**
A: `pp`λ” **SafeDelete ν•¨μκ°€ λλ‚λ©΄ μ–΄μ°¨ν”Ό μ‚¬λΌμ§ μ§€μ—­ λ³€μ(Stack)**μ΄κΈ° λ•λ¬Έμ…λ‹λ‹¤.
- **μ¤‘μ”ν• κ±΄ λ°”κΉ¥ μ„Έμƒ(`main`)μ— μλ” λ³€μ**λ¥Ό `nullptr`λ΅ λ§λ“λ” κ²λ‹λ‹¤. (`*pp = nullptr`μ μ—­ν• )
- `pp` μμ²΄λ” `SafeDelete` ν•¨μκ°€ λλ‚λ©΄ μ¤νƒμ—μ„ μλ™ μ†λ©Έλλ―€λ΅, κµ³μ΄ `nullptr`μ„ λ„£μ„ ν•„μ”κ°€ μ—†μµλ‹λ‹¤. (λ„£μ–΄λ„ μλ―Έ μ—†μ)

κ·Έλμ„ λ°λ“μ‹ `p = nullptr`λ΅ "μ½μ§€μ λ‚΄μ©λ„ μ§€μ›μ¤μ•Ό" μ•μ „ν•©λ‹λ‹¤.

---

## 2. μ•μ „ν• ν•΄μ  μ „λµ: `nullptr` μ„Ένƒ π§Ό
λ©”λ¨λ¦¬λ¥Ό ν•΄μ ν•μλ§μ ν¬μΈν„°μ— `nullptr`(μ£Όμ† 0λ²μ§€)μ„ λ€μ…ν•μ—¬, **"λ” μ΄μƒ μ ν¨ν•μ§€ μ•μ"**μ„ λ…μ‹ν•©λ‹λ‹¤.

```cpp
delete p;
p = nullptr; // μ΄μ  pλ” μ•„λ¬΄λ°λ„ κ°€λ¦¬ν‚¤μ§€ μ•μ (SAFE)

// ...
if (p != nullptr) { // μ•μ „ν•κ² μ²΄ν¬ κ°€λ¥
    *p = 20;
}
```

> **μµκ΄€**: `delete`μ™€ `nullptr` λ€μ…μ€ **ν• μ„ΈνΈ**λΌκ³  μƒκ°ν•μ„Έμ”.

---

## 3. Use-After-Return (μ¤νƒμ λ•κΈ€λ§)
λ™μ  ν• λ‹ΉλΏλ§ μ•„λ‹λΌ μ¤νƒμ—μ„λ„ λ•κΈ€λ§ ν¬μΈν„°κ°€ λ°μƒν•  μ μμµλ‹λ‹¤.

```cpp
int* DangerousFunc() {
    int local = 100;
    return &local; // [μΉλ…μ  μ—λ¬] μ§€μ—­ λ³€μλ” ν•¨μ λλ‚λ©΄ μ£½λ”λ°, κ·Έ μ£Όμ†λ¥Ό λ¦¬ν„΄?
}
```
ν•¨μκ°€ λλ‚λ©΄ `local` λ³€μλ” μ‚¬λΌμ§‘λ‹λ‹¤. λ¦¬ν„΄λ°›μ€ ν¬μΈν„°λ” **μ‚¬λΌμ§„ μ λ Ή**μ„ κ°€λ¦¬ν‚¤κ² λ©λ‹λ‹¤. μ λ€ κΈμ§€! β
